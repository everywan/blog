## Transaction
事务(Transaction)是由一系列对系统中数据进行访问与更新的操作所组成的一个程序执行逻辑单元(Unit), 狭义上的事务特指数据库事务.

## ACID
ACID 是指数据库在写入或更新数据的过程中, 为保证事务是正确可靠所依赖的四个特性: 原子性(atomicity), 一致性(consistency), 隔离性(isolation), 持久性(durability).

保证事务可靠, 主要解决以下问题
- 并发事务读写相同数据, 事务提供相应的隔离方法, 防止彼此操作互相干扰.
- 事务执行操作异常时回滚

#### 原子性
一个事务中的所有操作, 要么全部完成, 要么全部不完成. 如果执行过程中发生失败, 那么数据库将数据回滚到事务开始时的状态.

#### 一致性
1. 事务必须从一个一致性状态转换到另一个一致性状态.
    - 一致性状态: 多个进程/事务 读取数据的一致性. 既事务 A/B 同时读写数据 a 时, A/B 读取结果的一致性.
2. 按照一致性等级, 有以下级别
    - 强一致性: 数据的更新操作可以立即被读操作读取, 对于并发事务而言, 是指更新操作完成之后, 才可以进行读操作(锁); 对于分布式系统而言, 是指所有的节点数据都是相同的.
    - 弱一致性: 数据的更新操作不一定立即被读操作读取, 既不对数据的更新和读取做特别的操作, 两个事务/操作独立进行.
    - 最终一致性: 最终一致性多数用于分布式系统, 指系统中所有的数据副本, 在经过一段时间的同步后,最终达到一致性状态. 最终一致性是弱一致性的特例.
        - 最终一致性有以下变种实现: `[因果一致性,读己之所写,会话一致性,单调读一致性,单调写一致性]`

#### 隔离性
1. 事务并发执行时互相的干扰程度. 如事务 A 在更改数据 a 的过程中, 事务 B 是否能读取到 a 正在修改的数据(事务 A 正在执行).
2. 不设置隔离时存在的问题
    - 脏读: 事务 A 修改数据 a, 但是尚未提交 --> 并发事务 B 读取到了修改后的 a 值 --> 事务 A 执行失败, 数据回滚, 事务 B 读取的值. 
        - 需要加锁解决
    - 幻读: 同一事务内多次查询的值不同: 事务A第一次查询数据得到结果 r1 --> 事务 B 添加/删除了一条记录 --> 事务 A 再次查询, 得到的结果r2与第一次不同
        - 需要将事务串行化执行
3. 事务隔离级别如下
    - 
